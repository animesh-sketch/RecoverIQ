<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>RecoverIQ â€” Collections Intelligence</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>

<!-- â•â• Sidebar â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<aside class="sidebar">
  <div class="sb-brand">
    <div class="sb-logo">âš¡</div>
    <div>
      <div class="sb-name">RecoverIQ</div>
      <div class="sb-tagline">Collections Intelligence</div>
    </div>
  </div>

  <nav class="sb-nav">
    <div class="sb-nav-item active"><span>â—ˆ</span> Dashboard</div>
    <div class="sb-nav-item" onclick="document.getElementById('fileInput').click()"><span>â†‘</span> Upload Data</div>
    <div class="sb-nav-item" onclick="loadDemo()"><span>â†º</span> Reset Demo</div>
  </nav>

  <div class="sb-upload" id="uploadZone">
    <input type="file" id="fileInput" accept=".csv" style="display:none" onchange="handleFile(event)"/>
    <div class="sb-upload-icon">ðŸ“‚</div>
    <div class="sb-upload-title">Drop CSV to analyse</div>
    <div class="sb-upload-hint">or click to browse</div>
    <div class="sb-upload-cols">
      Lead_Entity_Disposition &nbsp;Â·&nbsp; Lead_State<br>
      AI_Attempted_Calls &nbsp;Â·&nbsp; AI_Connected_Calls<br>
      Total_Spend_INR
    </div>
  </div>

  <div class="sb-stats" id="sidebarStats"></div>
  <div class="sb-footer">RecoverIQ v2.0 &nbsp;Â·&nbsp; AI-Powered Analytics</div>
</aside>

<!-- â•â• Main â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main class="main">

  <!-- Top bar -->
  <header class="topbar">
    <div>
      <h1 class="topbar-title">Campaign Intelligence</h1>
      <span class="topbar-sub">Executive Dashboard &nbsp;Â·&nbsp; Real-Time Analytics</span>
    </div>
    <div class="topbar-right">
      <span class="chip chip-blue">âš¡ AI-Powered</span>
      <span class="chip chip-gold" id="dataChip">Demo Data</span>
    </div>
  </header>

  <!-- Loading -->
  <div class="loading-veil" id="loadingVeil">
    <div class="loading-ring"></div>
    <span class="loading-label">Analysing dataâ€¦</span>
  </div>

  <!-- Error -->
  <div class="error-strip" id="errorStrip">
    <span class="error-icon">âš </span>
    <span id="errorMsg"></span>
    <button onclick="hideError()">âœ•</button>
  </div>

  <!-- â”€â”€ 01 Â· Campaign Overview â”€â”€ -->
  <section class="section">
    <div class="sec-hdr"><span class="sec-num">01</span><span class="sec-label">Campaign Overview</span></div>
    <div class="kpi-grid" id="kpiGrid"></div>
    <div class="health-bar" id="healthBar"></div>
  </section>

  <!-- â”€â”€ 02 Â· Campaign Score â”€â”€ -->
  <section class="section">
    <div class="sec-hdr"><span class="sec-num">02</span><span class="sec-label">Campaign Score</span></div>
    <div class="score-layout">
      <div id="scoreCard"></div>
      <div class="chart-box">
        <div class="chart-title">Score Components</div>
        <canvas id="scoreChart" height="180"></canvas>
      </div>
      <div class="chart-box">
        <div class="chart-title">Lead State Distribution</div>
        <canvas id="stateChart" height="180"></canvas>
      </div>
    </div>
  </section>

  <!-- â”€â”€ 03 Â· Funnel Intelligence â”€â”€ -->
  <section class="section">
    <div class="sec-hdr"><span class="sec-num">03</span><span class="sec-label">Funnel Intelligence</span></div>
    <div class="funnel-layout">
      <div class="chart-box funnel-box">
        <div class="chart-title">Conversion Funnel</div>
        <div id="funnelViz"></div>
      </div>
      <div class="chart-box">
        <div class="chart-title">Stage Drop-off</div>
        <div id="dropoffList"></div>
        <div id="dropoffCallout"></div>
      </div>
      <div class="chart-box">
        <div class="chart-title">Connection by Disposition</div>
        <canvas id="connDispChart" height="220"></canvas>
      </div>
    </div>
  </section>

  <!-- â”€â”€ 04 Â· Efficiency Snapshot â”€â”€ -->
  <section class="section">
    <div class="sec-hdr"><span class="sec-num">04</span><span class="sec-label">Efficiency Snapshot</span></div>
    <div class="eff-layout">
      <div class="table-box">
        <div class="chart-title">Retry & Attempt Logic</div>
        <div id="retryTable"></div>
      </div>
      <div class="table-box">
        <div class="chart-title">Cost Efficiency</div>
        <div id="costTable"></div>
      </div>
    </div>
    <div class="chart-row">
      <div class="chart-box flex2">
        <div class="chart-title">Disposition Distribution</div>
        <canvas id="dispChart" height="140"></canvas>
      </div>
      <div class="chart-box flex1">
        <div class="chart-title">Disposition Mix</div>
        <canvas id="donutChart" height="220"></canvas>
      </div>
    </div>
  </section>

  <!-- â”€â”€ 05 Â· Deep Analytics â”€â”€ -->
  <section class="section">
    <div class="sec-hdr"><span class="sec-num">05</span><span class="sec-label">Deep Analytics</span></div>
    <div class="chart-row">
      <div class="chart-box flex1">
        <div class="chart-title">Spend vs Attempts &nbsp;<span class="chart-sub">(sampled leads)</span></div>
        <canvas id="scatterChart" height="240"></canvas>
      </div>
      <div class="chart-box flex1">
        <div class="chart-title">Attempt Distribution</div>
        <canvas id="attDistChart" height="240"></canvas>
      </div>
    </div>
    <div class="chart-row" style="margin-top:16px">
      <div class="chart-box flex1">
        <div class="chart-title">Spend Distribution</div>
        <canvas id="spendHistChart" height="200"></canvas>
      </div>
    </div>
  </section>

  <!-- â”€â”€ 06 Â· Risk Radar â”€â”€ -->
  <section class="section">
    <div class="sec-hdr"><span class="sec-num">06</span><span class="sec-label">Risk Radar</span></div>
    <div class="risk-grid" id="riskGrid"></div>
  </section>

  <!-- â”€â”€ 07 Â· Optimisation Levers â”€â”€ -->
  <section class="section">
    <div class="sec-hdr"><span class="sec-num">07</span><span class="sec-label">Top 3 Optimisation Levers</span></div>
    <div id="leverList"></div>
  </section>

  <footer class="dash-footer">
    RecoverIQ Collections Intelligence &nbsp;Â·&nbsp; Powered by AI &nbsp;Â·&nbsp; Confidential
  </footer>
</main>

<script>const INITIAL_DATA = {{ initial_data | safe }};</script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>
